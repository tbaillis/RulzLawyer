<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Creation Wizard - RulzLawyer</title>
    
    <!-- External Libraries -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        /* === Theme Variables === */
        :root {
            --primary-gold: #D4AF37;
            --deep-red: #8B0000;
            --parchment: #F5F5DC;
            --dark-brown: #654321;
            --emerald: #50C878;
            --shadow: rgba(0,0,0,0.3);
            --text-dark: #2C1810;
            --accent-blue: #4169E1;
        }

        /* === Global Styles === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--parchment) 0%, #E8E8E8 100%);
            color: var(--text-dark);
            min-height: 100vh;
        }

        .wizard-container {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .wizard-header {
            background: linear-gradient(90deg, var(--deep-red) 0%, var(--dark-brown) 100%);
            color: var(--primary-gold);
            padding: 2rem;
            border-radius: 15px 15px 0 0;
            text-align: center;
        }

        .wizard-title {
            font-family: 'Cinzel', serif;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .progress-container {
            background: rgba(255,255,255,0.9);
            padding: 1.5rem;
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .step-indicator {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            padding: 0.5rem;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .step-indicator.active {
            background: var(--primary-gold);
            color: white;
        }

        .step-indicator.completed {
            background: var(--emerald);
            color: white;
        }

        .step-container {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 6px var(--shadow);
        }

        .step-container.active {
            display: block;
        }

        .step-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            color: var(--deep-red);
            margin-bottom: 1rem;
        }

        .step-description {
            color: var(--dark-brown);
            margin-bottom: 2rem;
            font-size: 1.1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: var(--primary-gold);
            color: white;
        }

        .btn-primary:hover {
            background: #B8941F;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: var(--dark-brown);
            color: white;
        }

        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--primary-gold);
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark-brown);
        }

        .input-group input, .input-group select, .input-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .selection-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .selection-card {
            background: linear-gradient(145deg, var(--parchment), #E8E8E8);
            border: 3px solid transparent;
            border-radius: 15px;
            padding: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .selection-card:hover {
            border-color: var(--primary-gold);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px var(--shadow);
        }

        .selection-card.selected {
            border-color: var(--emerald);
            background: linear-gradient(145deg, #E8F5E8, #D4EDD4);
        }

        .card-title {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: var(--deep-red);
            margin-bottom: 0.5rem;
        }

        .card-description {
            color: var(--dark-brown);
            font-size: 0.95rem;
        }

        /* === Responsive Design === */
        @media (max-width: 768px) {
            .wizard-container {
                margin: 1rem;
                padding: 0 1rem;
            }
            
            .wizard-title {
                font-size: 2rem;
            }
            
            .selection-grid {
                grid-template-columns: 1fr;
            }
            
            .navigation-buttons {
                flex-direction: column;
                gap: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="wizard-container">
        <!-- Wizard Header -->
        <div class="wizard-header">
            <h1 class="wizard-title">Character Creation Wizard</h1>
            <p class="wizard-subtitle">Create your D&D 3.5 Character</p>
        </div>

        <!-- Progress Indicator -->
        <div class="progress-container">
            <div class="progress-steps">
                <div class="step-indicator active" data-step="1">
                    <i class="fas fa-user"></i>
                    <span>Basic Info</span>
                </div>
                <div class="step-indicator" data-step="2">
                    <i class="fas fa-users"></i>
                    <span>Race</span>
                </div>
                <div class="step-indicator" data-step="3">
                    <i class="fas fa-shield-alt"></i>
                    <span>Class</span>
                </div>
                <div class="step-indicator" data-step="4">
                    <i class="fas fa-chart-bar"></i>
                    <span>Abilities</span>
                </div>
                <div class="step-indicator" data-step="5">
                    <i class="fas fa-cogs"></i>
                    <span>Skills</span>
                </div>
                <div class="step-indicator" data-step="6">
                    <i class="fas fa-star"></i>
                    <span>Feats</span>
                </div>
                <div class="step-indicator" data-step="7">
                    <i class="fas fa-sword"></i>
                    <span>Equipment</span>
                </div>
            </div>
        </div>

        <!-- Step Content -->
        <div class="step-content">
            <!-- Step 1: Basic Information -->
            <div class="step-container active" data-step="1">
                <h2 class="step-title">Basic Character Information</h2>
                <p class="step-description">Enter the basic details for your character</p>
                
                <div class="input-group">
                    <label for="characterName">Character Name</label>
                    <input type="text" id="characterName" placeholder="Enter character name">
                </div>
                
                <div class="input-group">
                    <label for="playerName">Player Name</label>
                    <input type="text" id="playerName" placeholder="Enter your name">
                </div>
                
                <div class="input-group">
                    <label for="characterBackground">Background</label>
                    <textarea id="characterBackground" rows="4" placeholder="Describe your character's background"></textarea>
                </div>
            </div>

            <!-- Step 2: Race Selection -->
            <div class="step-container" data-step="2">
                <h2 class="step-title">Choose Your Race</h2>
                <p class="step-description">Select your character's race</p>
                
                <div class="selection-grid">
                    <div class="selection-card" data-race="human">
                        <div class="card-title">Human</div>
                        <div class="card-description">Versatile and ambitious, humans are the most adaptable of all races.</div>
                    </div>
                    <div class="selection-card" data-race="elf">
                        <div class="card-title">Elf</div>
                        <div class="card-description">Graceful and long-lived, elves are masters of magic and bow.</div>
                    </div>
                    <div class="selection-card" data-race="dwarf">
                        <div class="card-title">Dwarf</div>
                        <div class="card-description">Hardy and traditional, dwarves are renowned craftsmen and warriors.</div>
                    </div>
                    <div class="selection-card" data-race="halfling">
                        <div class="card-title">Halfling</div>
                        <div class="card-description">Small and nimble, halflings are naturally lucky and brave.</div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Class Selection -->
            <div class="step-container" data-step="3">
                <h2 class="step-title">Choose Your Class</h2>
                <p class="step-description">Select your character's class</p>
                
                <div class="selection-grid">
                    <div class="selection-card" data-class="fighter">
                        <div class="card-title">Fighter</div>
                        <div class="card-description">Master of weapons and tactics, skilled in all forms of combat.</div>
                    </div>
                    <div class="selection-card" data-class="wizard">
                        <div class="card-title">Wizard</div>
                        <div class="card-description">Student of arcane magic, wielding spells through study and preparation.</div>
                    </div>
                    <div class="selection-card" data-class="cleric">
                        <div class="card-title">Cleric</div>
                        <div class="card-description">Divine spellcaster, channeling the power of their deity.</div>
                    </div>
                    <div class="selection-card" data-class="rogue">
                        <div class="card-title">Rogue</div>
                        <div class="card-description">Master of stealth and precision, skilled in finding and exploiting weaknesses.</div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Ability Scores -->
            <div class="step-container" data-step="4">
                <h2 class="step-title">Ability Scores</h2>
                <p class="step-description">Generate or assign your character's ability scores</p>
                
                <div class="input-group">
                    <button class="btn btn-primary" id="rollAbilitiesBtn">
                        <i class="fas fa-dice"></i>
                        Roll Ability Scores (4d6, drop lowest)
                    </button>
                </div>
                
                <div id="abilityScores" style="display: none;">
                    <div class="selection-grid">
                        <div class="input-group">
                            <label for="strength">Strength</label>
                            <input type="number" id="strength" min="3" max="18" readonly>
                        </div>
                        <div class="input-group">
                            <label for="dexterity">Dexterity</label>
                            <input type="number" id="dexterity" min="3" max="18" readonly>
                        </div>
                        <div class="input-group">
                            <label for="constitution">Constitution</label>
                            <input type="number" id="constitution" min="3" max="18" readonly>
                        </div>
                        <div class="input-group">
                            <label for="intelligence">Intelligence</label>
                            <input type="number" id="intelligence" min="3" max="18" readonly>
                        </div>
                        <div class="input-group">
                            <label for="wisdom">Wisdom</label>
                            <input type="number" id="wisdom" min="3" max="18" readonly>
                        </div>
                        <div class="input-group">
                            <label for="charisma">Charisma</label>
                            <input type="number" id="charisma" min="3" max="18" readonly>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 5: Skills -->
            <div class="step-container" data-step="5">
                <h2 class="step-title">Skills</h2>
                <p class="step-description">Allocate your skill points</p>
                
                <p>Skill system will be implemented here. Available skill points will be calculated based on class and intelligence modifier.</p>
            </div>

            <!-- Step 6: Feats -->
            <div class="step-container" data-step="6">
                <h2 class="step-title">Feats</h2>
                <p class="step-description">Select your starting feats</p>
                
                <p>Your character will receive appropriate starting feats based on race and class.</p>
            </div>

            <!-- Step 7: Equipment -->
            <div class="step-container" data-step="7">
                <h2 class="step-title">Starting Equipment</h2>
                <p class="step-description">Select your character's starting equipment</p>
                
                <p><strong>Note for Next AI Team:</strong> This step needs to be enhanced with:</p>
                <ul>
                    <li>Advanced inventory management system with drag-and-drop</li>
                    <li>Spell selection for spellcasting classes (Wizard, Cleric, etc.)</li>
                    <li>Equipment presets (Combat, Exploration, Social, Survival)</li>
                    <li>Wealth management and starting gold calculation</li>
                </ul>
                
                <div class="input-group">
                    <label for="startingGold">Starting Gold</label>
                    <input type="number" id="startingGold" placeholder="Roll or enter starting gold">
                </div>
                
                <div class="input-group">
                    <label for="equipment">Equipment List</label>
                    <textarea id="equipment" rows="6" placeholder="List your starting equipment"></textarea>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation-buttons">
            <button class="btn btn-secondary" id="prevBtn" style="display: none;">
                <i class="fas fa-arrow-left"></i>
                Previous
            </button>
            <button class="btn btn-secondary" id="resetBtn">
                <i class="fas fa-redo"></i>
                Reset
            </button>
            <button class="btn btn-primary" id="nextBtn">
                Next
                <i class="fas fa-arrow-right"></i>
            </button>
        </div>
    </div>

    <!-- Load dependencies -->
    <script src="/app.js"></script>
    
    <script>
        // === Character Wizard State ===
        let wizardState = {
            currentStep: 1,
            totalSteps: 7,
            characterData: {},
            sessionId: null
        };

        let gameEngine = null;
        let characterManager = null;

        // === Initialize Wizard ===
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('🧙‍♂️ Character Creation Wizard initializing...');
            
            // Wait for game engine
            if (window.gameEngine) {
                gameEngine = window.gameEngine;
                characterManager = gameEngine.characterManager;
                console.log('✅ Game engine connected');
            } else {
                console.warn('⚠️  Game engine not available - using fallback mode');
            }
            
            // Initialize wizard
            initializeWizard();
            setupEventListeners();
            
            console.log('✅ Character Creation Wizard ready');
        });

        // === Wizard Initialization ===
        function initializeWizard() {
            // Start a new creation session
            if (characterManager) {
                const session = characterManager.startCreationWizard();
                wizardState.sessionId = session.sessionId;
                console.log('🎯 Started wizard session:', session.sessionId);
            }
            
            updateWizardDisplay();
        }

        // === Event Listeners ===
        function setupEventListeners() {
            // Navigation buttons
            document.getElementById('nextBtn').addEventListener('click', nextStep);
            document.getElementById('prevBtn').addEventListener('click', prevStep);
            document.getElementById('resetBtn').addEventListener('click', resetWizard);
            
            // Race selection
            document.querySelectorAll('[data-race]').forEach(card => {
                card.addEventListener('click', () => selectRace(card.dataset.race));
            });
            
            // Class selection
            document.querySelectorAll('[data-class]').forEach(card => {
                card.addEventListener('click', () => selectClass(card.dataset.class));
            });
            
            // Ability score generation
            document.getElementById('rollAbilitiesBtn').addEventListener('click', rollAbilityScores);
            
            // Character info inputs
            document.getElementById('characterName').addEventListener('change', updateCharacterData);
            document.getElementById('playerName').addEventListener('change', updateCharacterData);
            document.getElementById('characterBackground').addEventListener('change', updateCharacterData);
        }

        // === Navigation Functions ===
        function nextStep() {
            if (wizardState.currentStep < wizardState.totalSteps) {
                wizardState.currentStep++;
                updateWizardDisplay();
            } else {
                completeWizard();
            }
        }

        function prevStep() {
            if (wizardState.currentStep > 1) {
                wizardState.currentStep--;
                updateWizardDisplay();
            }
        }

        function resetWizard() {
            if (confirm('Are you sure you want to reset the character creation? All progress will be lost.')) {
                wizardState.currentStep = 1;
                wizardState.characterData = {};
                updateWizardDisplay();
                clearAllInputs();
            }
        }

        // === Display Updates ===
        function updateWizardDisplay() {
            // Update step indicators
            document.querySelectorAll('.step-indicator').forEach(indicator => {
                const stepNum = parseInt(indicator.dataset.step);
                indicator.classList.remove('active', 'completed');
                
                if (stepNum === wizardState.currentStep) {
                    indicator.classList.add('active');
                } else if (stepNum < wizardState.currentStep) {
                    indicator.classList.add('completed');
                }
            });
            
            // Update step containers
            document.querySelectorAll('.step-container').forEach(container => {
                const stepNum = parseInt(container.dataset.step);
                container.classList.remove('active');
                
                if (stepNum === wizardState.currentStep) {
                    container.classList.add('active');
                }
            });
            
            // Update navigation buttons
            document.getElementById('prevBtn').style.display = 
                wizardState.currentStep > 1 ? 'block' : 'none';
            
            document.getElementById('nextBtn').textContent = 
                wizardState.currentStep === wizardState.totalSteps ? 'Complete Character' : 'Next';
        }

        // === Selection Functions ===
        function selectRace(race) {
            wizardState.characterData.race = race;
            
            // Update visual selection
            document.querySelectorAll('[data-race]').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-race="${race}"]`).classList.add('selected');
            
            console.log('Selected race:', race);
        }

        function selectClass(characterClass) {
            wizardState.characterData.class = characterClass;
            
            // Update visual selection
            document.querySelectorAll('[data-class]').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelector(`[data-class="${characterClass}"]`).classList.add('selected');
            
            console.log('Selected class:', characterClass);
        }

        // === Ability Score Generation ===
        function rollAbilityScores() {
            const abilities = ['strength', 'dexterity', 'constitution', 'intelligence', 'wisdom', 'charisma'];
            const scores = {};
            
            abilities.forEach(ability => {
                // Roll 4d6, drop lowest
                const rolls = Array.from({length: 4}, () => Math.floor(Math.random() * 6) + 1);
                rolls.sort((a, b) => b - a);
                const score = rolls.slice(0, 3).reduce((sum, roll) => sum + roll, 0);
                
                scores[ability] = score;
                document.getElementById(ability).value = score;
            });
            
            wizardState.characterData.abilities = scores;
            document.getElementById('abilityScores').style.display = 'block';
            
            console.log('Rolled ability scores:', scores);
        }

        // === Data Management ===
        function updateCharacterData() {
            const characterName = document.getElementById('characterName').value;
            const playerName = document.getElementById('playerName').value;
            const background = document.getElementById('characterBackground').value;
            
            wizardState.characterData.name = characterName;
            wizardState.characterData.player = playerName;
            wizardState.characterData.background = background;
        }

        function clearAllInputs() {
            document.getElementById('characterName').value = '';
            document.getElementById('playerName').value = '';
            document.getElementById('characterBackground').value = '';
            document.getElementById('abilityScores').style.display = 'none';
            
            document.querySelectorAll('.selection-card').forEach(card => {
                card.classList.remove('selected');
            });
        }

        // === Wizard Completion ===
        function completeWizard() {
            console.log('🎉 Character creation complete!', wizardState.characterData);
            
            // Here the enhanced system would save the character
            alert('Character creation complete! (Enhanced features to be implemented by next AI team)');
        }
    </script>
</body>
</html>