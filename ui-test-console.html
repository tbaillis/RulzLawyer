<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RulzLawyer UI Testing Console</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #1a1a2e;
            color: #e8e6e3;
            margin: 0;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: #16213e;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #d4af37;
        }
        .test-header {
            background: rgba(212, 175, 55, 0.1);
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            border-left: 4px solid #d4af37;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 3px solid #4a9eff;
        }
        .test-button {
            background: linear-gradient(135deg, #4a9eff, #0066cc);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
        }
        .test-button:hover {
            background: linear-gradient(135deg, #66b3ff, #0080ff);
            transform: translateY(-1px);
        }
        .status-ok { color: #4CAF50; }
        .status-error { color: #f44336; }
        .status-warning { color: #ff9800; }
        .test-output {
            background: #0a0a0a;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #444;
        }
        .iframe-container {
            background: white;
            border-radius: 8px;
            margin: 20px 0;
            height: 600px;
            border: 2px solid #d4af37;
        }
        iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 6px;
        }
        .test-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-header">
            <h1>üß™ RulzLawyer UI Testing Console</h1>
            <p>Comprehensive testing tool for validating UI button functionality and user interactions</p>
        </div>

        <div class="test-grid">
            <div>
                <div class="test-section">
                    <h3>üéØ Quick Tests</h3>
                    <button class="test-button" onclick="testApplicationLoad()">Test App Loading</button>
                    <button class="test-button" onclick="testNavigationTabs()">Test Navigation</button>
                    <button class="test-button" onclick="testDiceButtons()">Test Dice Buttons</button>
                    <button class="test-button" onclick="testCharacterButtons()">Test Character Buttons</button>
                    <button class="test-button" onclick="runAllTests()">Run All Tests</button>
                    <div id="quick-test-output" class="test-output"></div>
                </div>

                <div class="test-section">
                    <h3>üîç Interactive Tests</h3>
                    <button class="test-button" onclick="openCharacterCreationTest()">Character Creation Test</button>
                    <button class="test-button" onclick="testButtonClickEvents()">Button Event Test</button>
                    <button class="test-button" onclick="testFormSubmissions()">Form Submission Test</button>
                    <button class="test-button" onclick="testModalFunctionality()">Modal Test</button>
                    <div id="interactive-test-output" class="test-output"></div>
                </div>

                <div class="test-section">
                    <h3>üõ†Ô∏è Manual Testing Tools</h3>
                    <button class="test-button" onclick="inspectDOMElements()">Inspect DOM</button>
                    <button class="test-button" onclick="checkJavaScriptErrors()">Check JS Errors</button>
                    <button class="test-button" onclick="validateEventListeners()">Validate Events</button>
                    <button class="test-button" onclick="testStorageSystem()">Test Storage</button>
                    <div id="manual-test-output" class="test-output"></div>
                </div>
            </div>

            <div>
                <div class="test-section">
                    <h3>üìä Test Results</h3>
                    <div id="test-results-summary" class="test-output">
                        Click "Run All Tests" to see comprehensive results
                    </div>
                </div>

                <div class="test-section">
                    <h3>üéÆ Live Application</h3>
                    <div class="iframe-container">
                        <iframe id="app-iframe" src="http://localhost:3000" 
                                onload="logOutput('App iframe loaded successfully')"
                                onerror="logOutput('App iframe failed to load', 'error')">
                        </iframe>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üìã Console Log</h3>
            <div id="console-log" class="test-output">
                UI Testing Console initialized. Ready for testing...
            </div>
        </div>
    </div>

    <script>
        // Global test state
        let testResults = {
            passed: 0,
            failed: 0,
            warnings: 0,
            tests: []
        };

        // Utility functions
        function logOutput(message, type = 'info', targetId = 'console-log') {
            const timestamp = new Date().toLocaleTimeString();
            const element = document.getElementById(targetId);
            const className = type === 'error' ? 'status-error' : 
                             type === 'warning' ? 'status-warning' : 'status-ok';
            
            element.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            element.scrollTop = element.scrollHeight;
        }

        function getAppIframe() {
            return document.getElementById('app-iframe');
        }

        function executeInApp(code, callback) {
            const iframe = getAppIframe();
            try {
                const result = iframe.contentWindow.eval(code);
                callback(null, result);
            } catch (error) {
                callback(error, null);
            }
        }

        // Test functions
        function testApplicationLoad() {
            logOutput('Testing application load...', 'info', 'quick-test-output');
            
            const iframe = getAppIframe();
            const appUrl = iframe.src;
            
            fetch(appUrl)
                .then(response => {
                    if (response.ok) {
                        logOutput('‚úÖ Application loads successfully', 'info', 'quick-test-output');
                        testResults.passed++;
                    } else {
                        logOutput('‚ùå Application failed to load: ' + response.status, 'error', 'quick-test-output');
                        testResults.failed++;
                    }
                })
                .catch(error => {
                    logOutput('‚ùå Application load error: ' + error.message, 'error', 'quick-test-output');
                    testResults.failed++;
                });
        }

        function testNavigationTabs() {
            logOutput('Testing navigation tabs...', 'info', 'quick-test-output');
            
            executeInApp('document.querySelectorAll(".nav-tab").length', (error, result) => {
                if (error) {
                    logOutput('‚ùå Navigation tabs test failed: ' + error.message, 'error', 'quick-test-output');
                    testResults.failed++;
                } else {
                    logOutput(`‚úÖ Found ${result} navigation tabs`, 'info', 'quick-test-output');
                    testResults.passed++;
                    
                    // Test tab clicking
                    executeInApp('document.querySelector(".nav-tab[data-tab=\\"characters\\"]")', (err, tabElement) => {
                        if (tabElement) {
                            logOutput('‚úÖ Character tab element found', 'info', 'quick-test-output');
                        } else {
                            logOutput('‚ö†Ô∏è Character tab element not found', 'warning', 'quick-test-output');
                            testResults.warnings++;
                        }
                    });
                }
            });
        }

        function testDiceButtons() {
            logOutput('Testing dice buttons...', 'info', 'quick-test-output');
            
            executeInApp('document.querySelectorAll(".dice-btn").length', (error, result) => {
                if (error) {
                    logOutput('‚ùå Dice buttons test failed: ' + error.message, 'error', 'quick-test-output');
                    testResults.failed++;
                } else {
                    logOutput(`‚úÖ Found ${result} dice buttons`, 'info', 'quick-test-output');
                    testResults.passed++;
                    
                    // Test if rollDice function exists
                    executeInApp('typeof rollDice', (err, funcType) => {
                        if (funcType === 'function') {
                            logOutput('‚úÖ rollDice function is available', 'info', 'quick-test-output');
                        } else {
                            logOutput('‚ùå rollDice function not found', 'error', 'quick-test-output');
                            testResults.failed++;
                        }
                    });
                }
            });
        }

        function testCharacterButtons() {
            logOutput('Testing character buttons...', 'info', 'quick-test-output');
            
            executeInApp('typeof createNewCharacter', (error, result) => {
                if (result === 'function') {
                    logOutput('‚úÖ createNewCharacter function found', 'info', 'quick-test-output');
                    testResults.passed++;
                } else {
                    logOutput('‚ùå createNewCharacter function not found', 'error', 'quick-test-output');
                    testResults.failed++;
                }
            });
            
            executeInApp('typeof showCharacterStats', (error, result) => {
                if (result === 'function') {
                    logOutput('‚úÖ showCharacterStats function found', 'info', 'quick-test-output');
                    testResults.passed++;
                } else {
                    logOutput('‚ùå showCharacterStats function not found', 'error', 'quick-test-output');
                    testResults.failed++;
                }
            });
        }

        function openCharacterCreationTest() {
            logOutput('Opening character creation test...', 'info', 'interactive-test-output');
            
            executeInApp('createNewCharacter()', (error, result) => {
                if (error) {
                    logOutput('‚ùå Character creation failed: ' + error.message, 'error', 'interactive-test-output');
                } else {
                    logOutput('‚úÖ Character creation modal opened', 'info', 'interactive-test-output');
                    
                    // Check if modal is visible
                    executeInApp('document.getElementById("character-modal").style.display', (err, display) => {
                        if (display === 'block' || display === 'flex') {
                            logOutput('‚úÖ Character modal is visible', 'info', 'interactive-test-output');
                        } else {
                            logOutput('‚ö†Ô∏è Character modal visibility unclear', 'warning', 'interactive-test-output');
                        }
                    });
                }
            });
        }

        function testButtonClickEvents() {
            logOutput('Testing button click events...', 'info', 'interactive-test-output');
            
            // Test dice button clicks
            executeInApp('document.querySelector(".dice-btn[data-dice=\\"1d20\\"]").click()', (error, result) => {
                if (error) {
                    logOutput('‚ùå Dice button click failed: ' + error.message, 'error', 'interactive-test-output');
                } else {
                    logOutput('‚úÖ Dice button clicked successfully', 'info', 'interactive-test-output');
                }
            });
        }

        function testFormSubmissions() {
            logOutput('Testing form submissions...', 'info', 'interactive-test-output');
            
            // Check if character creation form exists
            executeInApp('document.getElementById("character-form")', (error, form) => {
                if (form) {
                    logOutput('‚úÖ Character form found', 'info', 'interactive-test-output');
                } else {
                    logOutput('‚ö†Ô∏è Character form not found', 'warning', 'interactive-test-output');
                }
            });
        }

        function testModalFunctionality() {
            logOutput('Testing modal functionality...', 'info', 'interactive-test-output');
            
            executeInApp('typeof openModal', (error, result) => {
                if (result === 'function') {
                    logOutput('‚úÖ openModal function found', 'info', 'interactive-test-output');
                } else {
                    logOutput('‚ùå openModal function not found', 'error', 'interactive-test-output');
                }
            });
            
            executeInApp('typeof closeModal', (error, result) => {
                if (result === 'function') {
                    logOutput('‚úÖ closeModal function found', 'info', 'interactive-test-output');
                } else {
                    logOutput('‚ùå closeModal function not found', 'error', 'interactive-test-output');
                }
            });
        }

        function inspectDOMElements() {
            logOutput('Inspecting DOM elements...', 'info', 'manual-test-output');
            
            executeInApp(`
                const elements = {
                    navTabs: document.querySelectorAll('.nav-tab').length,
                    diceButtons: document.querySelectorAll('.dice-btn').length,
                    actionButtons: document.querySelectorAll('.action-btn').length,
                    modals: document.querySelectorAll('.modal').length,
                    forms: document.querySelectorAll('form').length
                };
                JSON.stringify(elements);
            `, (error, result) => {
                if (error) {
                    logOutput('‚ùå DOM inspection failed: ' + error.message, 'error', 'manual-test-output');
                } else {
                    const elements = JSON.parse(result);
                    logOutput('‚úÖ DOM Elements:', 'info', 'manual-test-output');
                    logOutput(`  ‚Ä¢ Navigation tabs: ${elements.navTabs}`, 'info', 'manual-test-output');
                    logOutput(`  ‚Ä¢ Dice buttons: ${elements.diceButtons}`, 'info', 'manual-test-output');
                    logOutput(`  ‚Ä¢ Action buttons: ${elements.actionButtons}`, 'info', 'manual-test-output');
                    logOutput(`  ‚Ä¢ Modals: ${elements.modals}`, 'info', 'manual-test-output');
                    logOutput(`  ‚Ä¢ Forms: ${elements.forms}`, 'info', 'manual-test-output');
                }
            });
        }

        function checkJavaScriptErrors() {
            logOutput('Checking for JavaScript errors...', 'info', 'manual-test-output');
            
            executeInApp(`
                // Check if main objects are loaded
                const status = {
                    DiceEngine: typeof DiceEngine !== 'undefined',
                    CharacterManager: typeof CharacterManager !== 'undefined',
                    rollDice: typeof rollDice === 'function',
                    createNewCharacter: typeof createNewCharacter === 'function'
                };
                JSON.stringify(status);
            `, (error, result) => {
                if (error) {
                    logOutput('‚ùå JavaScript error check failed: ' + error.message, 'error', 'manual-test-output');
                } else {
                    const status = JSON.parse(result);
                    logOutput('‚úÖ JavaScript Status:', 'info', 'manual-test-output');
                    Object.entries(status).forEach(([key, value]) => {
                        const symbol = value ? '‚úÖ' : '‚ùå';
                        logOutput(`  ${symbol} ${key}: ${value}`, value ? 'info' : 'error', 'manual-test-output');
                    });
                }
            });
        }

        function validateEventListeners() {
            logOutput('Validating event listeners...', 'info', 'manual-test-output');
            
            executeInApp(`
                const events = {
                    diceButtonsWithEvents: Array.from(document.querySelectorAll('.dice-btn')).filter(btn => btn.onclick || btn.getAttribute('onclick')).length,
                    actionButtonsWithEvents: Array.from(document.querySelectorAll('.action-btn')).filter(btn => btn.onclick || btn.getAttribute('onclick')).length,
                    navTabsWithEvents: Array.from(document.querySelectorAll('.nav-tab')).filter(btn => btn.onclick || btn.getAttribute('onclick') || btn.dataset.tab).length
                };
                JSON.stringify(events);
            `, (error, result) => {
                if (error) {
                    logOutput('‚ùå Event listener validation failed: ' + error.message, 'error', 'manual-test-output');
                } else {
                    const events = JSON.parse(result);
                    logOutput('‚úÖ Event Listeners:', 'info', 'manual-test-output');
                    Object.entries(events).forEach(([key, value]) => {
                        logOutput(`  ‚Ä¢ ${key}: ${value}`, 'info', 'manual-test-output');
                    });
                }
            });
        }

        function testStorageSystem() {
            logOutput('Testing storage system...', 'info', 'manual-test-output');
            
            executeInApp(`
                try {
                    // Test localStorage
                    localStorage.setItem('test', 'value');
                    const testValue = localStorage.getItem('test');
                    localStorage.removeItem('test');
                    
                    // Check if StorageManager exists
                    const storageManager = typeof StorageManager !== 'undefined';
                    
                    JSON.stringify({
                        localStorageWorks: testValue === 'value',
                        storageManagerExists: storageManager
                    });
                } catch(e) {
                    JSON.stringify({ error: e.message });
                }
            `, (error, result) => {
                if (error) {
                    logOutput('‚ùå Storage test failed: ' + error.message, 'error', 'manual-test-output');
                } else {
                    const storage = JSON.parse(result);
                    if (storage.error) {
                        logOutput('‚ùå Storage error: ' + storage.error, 'error', 'manual-test-output');
                    } else {
                        logOutput('‚úÖ Storage System:', 'info', 'manual-test-output');
                        logOutput(`  ‚Ä¢ localStorage: ${storage.localStorageWorks ? '‚úÖ' : '‚ùå'}`, 'info', 'manual-test-output');
                        logOutput(`  ‚Ä¢ StorageManager: ${storage.storageManagerExists ? '‚úÖ' : '‚ùå'}`, 'info', 'manual-test-output');
                    }
                }
            });
        }

        function runAllTests() {
            logOutput('üöÄ Running comprehensive UI test suite...', 'info', 'test-results-summary');
            
            // Reset test results
            testResults = { passed: 0, failed: 0, warnings: 0, tests: [] };
            
            // Run all tests
            setTimeout(() => testApplicationLoad(), 100);
            setTimeout(() => testNavigationTabs(), 200);
            setTimeout(() => testDiceButtons(), 300);
            setTimeout(() => testCharacterButtons(), 400);
            setTimeout(() => checkJavaScriptErrors(), 500);
            setTimeout(() => validateEventListeners(), 600);
            setTimeout(() => inspectDOMElements(), 700);
            setTimeout(() => testStorageSystem(), 800);
            
            setTimeout(() => {
                logOutput('üìä Test Suite Complete:', 'info', 'test-results-summary');
                logOutput(`‚úÖ Passed: ${testResults.passed}`, 'info', 'test-results-summary');
                logOutput(`‚ùå Failed: ${testResults.failed}`, 'error', 'test-results-summary');
                logOutput(`‚ö†Ô∏è Warnings: ${testResults.warnings}`, 'warning', 'test-results-summary');
                
                const total = testResults.passed + testResults.failed;
                const successRate = total > 0 ? ((testResults.passed / total) * 100).toFixed(1) : 0;
                logOutput(`üìà Success Rate: ${successRate}%`, 'info', 'test-results-summary');
                
                if (testResults.failed === 0) {
                    logOutput('üéâ All tests passed! UI is functioning correctly.', 'info', 'test-results-summary');
                } else {
                    logOutput('‚ö†Ô∏è Some tests failed. Check individual test outputs for details.', 'warning', 'test-results-summary');
                }
            }, 1000);
        }

        // Auto-run basic tests on load
        window.addEventListener('load', () => {
            setTimeout(() => {
                logOutput('üîß UI Testing Console loaded. Running basic connectivity test...');
                testApplicationLoad();
            }, 1000);
        });
    </script>
</body>
</html>